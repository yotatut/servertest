<!DOCTYPE html>

<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å…¥å‡ºåº«ç™»éŒ²</title>


  <link rel="stylesheet" href="front/src/css/commonstylesheet.css">
  <link rel="stylesheet" href="front/src/css/nyusyukkostylesheet.css">

</head>

<body>


  <h2 class="heading">å…¥å‡ºåº«ç™»éŒ²</h2>
  <table id="myTable" class="registrationForm">

    <tr>
      <td class="rounded-box-attribute">
        æ—¥ä»˜ã€€ã€€ã€€ã€€&gt;
      </td>
      <td name="insertMongo" class="nowDate" id="nowDate">
        <!--<input type="date" id="nowDate">-->
      </td>
    </tr>
    <tr>
      <td class="rounded-box-attribute">
        åŒºåˆ†ã€€ã€€ã€€ã€€&gt;
      </td>
      <td>

        <!-- ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ -->
        <form name="insertMongo" id="myForm" class="rounded-box-field">
          <label class="molding">
            <input type="radio" name="flag" value=1> å…¥åº«
          </label>

          <label class="molding">
            <input type="radio" name="flag" value=2>å‡ºåº«
          </label>
        </form>
        <!--<script>
            // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ãŒé¸æŠã•ã‚ŒãŸã¨ãã®å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹å ´åˆ
            var radioButtons = document.querySelectorAll('input[type="radio"]');
            
            radioButtons.forEach(function(radioButton) {
              radioButton.addEventListener('change', function() {
                console.log('é¸æŠã•ã‚ŒãŸå€¤:', this.value);
              });
            });
        </script> -->
      </td>
    </tr>

    <tr>
      <td class="rounded-box-attribute" id="rounded-box-main">
        Barcodeã€€&nbsp;<span class="text-right">&gt;</span>
        <a class="scanner" href="front/production/barcodeScan.html">Go to Scan</a>
      </td>
      <td class="receivedBarcode" id="receivedBarcode"></td>
    </tr>
    <tr>
      <td class="rounded-box-attribute">
        æ•°é‡ã€€ã€€ã€€ã€€&gt;
      </td>
      <td>
        <input class="amount" type="text" name="insertMongo" value="ã“ã“ã«æ•°é‡ã‚’å…¥åŠ›">
      </td>
    </tr>
  </table>

  <button type="submit" class="insertButton button" onclick="" value="">ğŸ–Šç™»éŒ²</button><!--mongo_insert()-->
  <!--<input type="hidden" name="delete_id" value="test">-->
  <script src="front/src/utils/getCurrentDate.js"></script>
  <script src="front/src/utils/getQueryParam.js"></script>
  <script src="front/src/utils/getSelectedRadioButton.js"></script>
</body>

</html>

<button type="button" onclick="tableValuesToJSON()">Convert to JSON</button>

<script>
  function tableValuesToJSON() {
    // tableè¦ç´ ã‚’å–å¾—
    var table = document.getElementById('myTable');

    // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã§å–å¾—ã—ãŸè¦ç´ ãŒæ­£ã—ã„ã‹ç¢ºèª
    console.log('Table Element:', table);

    // JSONå½¢å¼ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–
    var jsonData = [];

    // å„è¡Œã”ã¨ã«å‡¦ç†
    for (var i = 0; i < table.rows.length; i++) {
      var row = table.rows[i];

      // å„ã‚»ãƒ«ã”ã¨ã«å‡¦ç†
      for (var j = 0; j < row.cells.length; j++) {
        var cell = row.cells[j];

        // inputè¦ç´ ã‚’å–å¾—
        var input = cell.getElementsByName('insertMongo');

        // inputè¦ç´ ãŒã‚ã‚‹å ´åˆã€ãã®valueã‚’å–å¾—ã—ã€JSONå½¢å¼ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ 
        if (input) {
          var value = input.value;
          jsonData.push({ row: i, column: j, value: value });
        }
      }
    }

    // JSONå½¢å¼ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’JSONæ–‡å­—åˆ—ã«å¤‰æ›
    // var jsonString = JSON.stringify(jsonData, null, 2);

    fetch('/submit', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(jsonData)
    })
      .then(response => response.json())
      .then(data => console.log(data))
      .catch(error => console.error('Error:', error));

    // JSONæ–‡å­—åˆ—ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤º
    // console.log(jsonString);

    // ã“ã“ã§JSONæ–‡å­—åˆ—ã‚’è¡¨ç¤ºã™ã‚‹ãªã©ã®å‡¦ç†ã‚’è¿½åŠ ã—ã¦ã‚‚è‰¯ã„
  }
</script>

</body>

</html>